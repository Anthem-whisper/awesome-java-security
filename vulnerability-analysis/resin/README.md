**目录**
- 特性1-支持.jspf后缀
- 特性2-类IIS6.0的解析漏洞


### 特性1-支持.jspf后缀
配置文件

> E:\Resin\resin-4.0.65\conf\app-default.xml

![image](https://user-images.githubusercontent.com/55024146/144174160-82c02d3b-a775-4b71-acaf-d9f03f2b3653.png)

可见Resin不仅支持.jsp、.jspx，也支持.jspf。

```jsp
<%
    response.getWriter().write("Hello Resin !!!");
%>
```
![image](https://user-images.githubusercontent.com/55024146/144174179-d1e5af4c-c1cc-4f41-a5da-7fa2eb977b66.png)

### 特性2-类IIS6.0的解析漏洞

先看测试效果图

![image](https://user-images.githubusercontent.com/55024146/144174242-db437f8b-0feb-4683-8e46-7e7586905a15.png)

希望传达的意思

- 若文件夹名为`xxx.jsp`，其中放置的任意后缀的文件都将被当作JSP文件解析。

#### 1、为什么会这样？

分三步跟一下http请求的处理过程，来到关键函数下个断点

- com.caucho.server.dispatch.UrlMap#map

**第1步：jsp文件**

![image](https://user-images.githubusercontent.com/55024146/144174286-61ce59f9-da8f-47da-bb5a-60c65de85aab.png)

![image](https://user-images.githubusercontent.com/55024146/144174296-2f6a4527-c1bb-4199-b5b9-d108216991bc.png)

正常进入jsp的解析逻辑

![image](https://user-images.githubusercontent.com/55024146/144174317-03477b55-7f9c-4550-9e06-cb21fb4cd300.png)

**第2步：非jsp文件**

![image](https://user-images.githubusercontent.com/55024146/144174351-15c3b0f6-df52-4c02-9322-bb0f76a3b2bf.png)

![image](https://user-images.githubusercontent.com/55024146/144174357-ba30fda0-d499-4929-8234-f0778f09039b.png)

进入resin-file的处理逻辑

![image](https://user-images.githubusercontent.com/55024146/144174378-bf20140b-fedf-4507-bef2-445187820ab2.png)

处理结果

![image](https://user-images.githubusercontent.com/55024146/144174406-2259125d-b101-4073-94d5-01b8f9d67d96.png)

**第3步：x.jsp文件夹 + 非.jsp文件**

![image](https://user-images.githubusercontent.com/55024146/144174432-3c2e4d49-7cc2-48ae-928e-60c9af933411.png)

![image](https://user-images.githubusercontent.com/55024146/144174451-3cd87542-0dad-41de-ad7f-48a9359d8ef2.png)

![image](https://user-images.githubusercontent.com/55024146/144174460-5f803d3c-8b6f-42e6-9f81-4def07970343.png)

也进入resin-file的处理逻辑

![image](https://user-images.githubusercontent.com/55024146/144174477-b242ffb6-6d62-442c-98a7-ea6a7cb11206.png)

#### 2、造成这种处理差异的原理是什么？

![image](https://user-images.githubusercontent.com/55024146/144174511-0cdabaf9-33c1-4c6e-aca5-c27c4ade0801.png)

map方法将会对url路径进行正则表达式，然后根据匹配结果进入不同的处理逻辑

> /hello.jsp

![image](https://user-images.githubusercontent.com/55024146/144174547-64dc2dba-d06b-4591-8f01-3ad408648d96.png)

> /hello.hello

![image](https://user-images.githubusercontent.com/55024146/144174573-43a536d0-d35f-40e2-8ecd-0b79f1d66723.png)

> /x.jsp/hello.hello

![image](https://user-images.githubusercontent.com/55024146/144174584-858aca20-2946-4f46-808d-7da2c1b733ad.png)






















